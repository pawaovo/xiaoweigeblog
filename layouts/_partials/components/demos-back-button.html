{{/*
  Demosé¡µé¢æ™ºèƒ½è¿”å›æŒ‰é’®ç»„ä»¶
  å‚æ•°ï¼š
  - .url: é»˜è®¤è¿”å›é“¾æ¥URLï¼ˆå¯é€‰ï¼Œç”¨äºå›é€€ï¼‰
  - .title: é»˜è®¤æŒ‰é’®æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰
  - .event: ç»Ÿè®¡äº‹ä»¶åç§°ï¼ˆå¯é€‰ï¼‰
*/}}
{{ $defaultUrl := .url | default "/demos/" }}
{{ $defaultTitle := .title | default "è¿”å›" }}
{{ $defaultEvent := .event | default "ğŸ”™ Click back button" }}

<div class="demos-back-button">
    <a href="{{ $defaultUrl }}"
       id="smart-back-btn"
       class="demos-back-btn"
       data-umami-event="{{ $defaultEvent }}"
       title="{{ $defaultTitle }}">
        <svg width="36" height="36" fill="currentColor" viewBox="0 0 32 32" style="transform: rotate(90deg);">
            <path d="M1.219 7.649c6.641 0 6.91 0.090 6.91 0.090 8.565-13.92 15.346 5.020 16.225 11.872l-2.509 0.011 4.908 8.568 4.713-8.542-2.441-0.101c-5.631-19.647-20.723-20.513-27.806-11.898v0z"/>
        </svg>
    </a>
</div>

<script>
(function() {
    'use strict';

    function setupSmartBackButton() {
        const backBtn = document.getElementById('smart-back-btn');
        if (!backBtn) return;

        const referrer = document.referrer;
        if (!referrer || !referrer.includes(window.location.host)) return;

        // è·¯ç”±æ˜ å°„è¡¨ - æ›´é«˜æ•ˆçš„åŒ¹é…é€»è¾‘
        const routes = [
            { pattern: '/posts', url: '/posts/', title: 'è¿”å›æ–‡ç« ', event: 'ğŸ”™ Click back to posts from demo detail' },
            { pattern: '/demos', url: '/demos/', title: 'è¿”å›Demos', event: 'ğŸ”™ Click back to demos from detail' }
        ];

        // æ£€æŸ¥ç‰¹å®šè·¯ç”±
        for (const route of routes) {
            if (referrer.includes(route.pattern)) {
                backBtn.href = route.url;
                backBtn.title = route.title;
                backBtn.setAttribute('data-umami-event', route.event);
                return;
            }
        }

        // æ£€æŸ¥æ˜¯å¦æ¥è‡ªä¸»é¡µï¼ˆç²¾ç¡®åŒ¹é…ï¼‰
        const siteBase = `${window.location.protocol}//${window.location.host}`;
        if (referrer === siteBase + '/' ||
            referrer === siteBase + '/zh/' ||
            referrer.includes('/#')) {
            backBtn.href = '/';
            backBtn.title = 'è¿”å›é¦–é¡µ';
            backBtn.setAttribute('data-umami-event', 'ğŸ”™ Click back to home from demo detail');
        }
    }

    // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
    document.readyState === 'loading'
        ? document.addEventListener('DOMContentLoaded', setupSmartBackButton)
        : setupSmartBackButton();
})();
</script>